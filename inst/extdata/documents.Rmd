---
title: "Generic document summaries"
author: "Leo Lahti"
date: "`r Sys.Date()`"
output: markdown_document
---


### Publication year

[Publication year conversions](output.tables/publication_year_conversion.csv)

[Publication year discarded](output.tables/publication_year_discarded.csv)

Publication year is available for `r sum(!is.na(df$publication_year))` documents (`r round(100*mean(!is.na(df$publication_year)))`%). The publication years span `r paste(range(na.omit(df$publication_year)), collapse = "-")`

```{r summarypublicationyear, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=6}
# Title count per decade
df2 <- df %>% group_by(publication_decade) %>% filter(publication_decade < 2010) 
p <- ggplot(df2, aes(publication_decade)) +
     geom_bar() + scale_y_log10() +
     ggtitle("Title count timeline")
print(p)
```


### Titles

[Publication titles](output.tables/title_accepted.csv)

[Publication titles discarded](output.tables/title_discarded.csv)

[Title harmonization table](output.tables/title_conversion_nontrivial.csv)

Top-`r ntop` titles are shown together with the number of documents. This info is available for `r sum(!is.na(df$title))` documents (`r round(100*mean(!is.na(df$title)))`%). There are `r length(unique(df$title))` unique titles.

```{r summarytitle, echo=FALSE, message=FALSE, warning=FALSE, fig.width=16, fig.height=10}
p <- top_plot(df, "title", ntop = ntop) +
  ggtitle(paste("Top titles")) +
  scale_y_log10() +
  ylab("Documents")
print(p)
```

## Language

Statistics:

 * `r ncol(df %>% select(starts_with("language.")))-1` unique languages
 * `r length(union(grep(";", df$language), which(df$language == "Multiple languages")))` docs with multiple languages
 * `r sum(is.na(df$language))` docs (`r round(100*mean(is.na(df$language)),2)`%) with no recognized language 
 
[Language conversions](output.tables/language_conversions.csv) Language codes as in [marc database](http://www.loc.gov/marc/languages/language_code.html); new custom abbreviations can be added in [this table](https://github.com/rOpenGov/bibliographica/blob/master/inst/extdata/language_abbreviations.csv)

[Discarded languages](output.tables/language_discarded.csv)

Title count per language:

```{r summarylang, echo=FALSE, message=FALSE, warning=FALSE, fig.width=7, fig.height=6}
p <- top_plot(df, "language", nrow(dfs)) +
  ggtitle(paste("Languages")) +
  scale_y_log10() +
  ylab("Documents") +
  guides(color = "none")
print(p)
```

