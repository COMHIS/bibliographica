---
title: "Generic document summaries"
author: "Leo Lahti"
date: "`r Sys.Date()`"
output: markdown_document
---


### Publication year

[Publication year conversions](output.tables/publication_year_conversion_nontrivial.csv)

[Publication year discarded](output.tables/publication_year_discarded.csv)

Publication year is available for `r sum(!is.na(df$publication_year))` documents (`r round(100*mean(!is.na(df$publication_year)))`%). The publication years span `r paste(range(na.omit(df$publication_year)), collapse = "-")`

```{r summarypublicationyear, echo=FALSE, message=FALSE, warning=FALSE, fig.width=8, fig.height=6}
# Title count per decade
df2 <- df %>% group_by(publication_decade) %>% filter(publication_decade < 2010) 
p <- ggplot(df2, aes(publication_decade)) +
     geom_bar() + scale_y_log10() +
     ggtitle("Title count timeline")
print(p)
```


### Titles

[Publication titles](output.tables/title_accepted.csv)

[Publication titles discarded](output.tables/title_discarded.csv)

[Title harmonization table](output.tables/title_conversion_nontrivial.csv)

Top-`r ntop` titles are shown together with the number of documents. This info is available for `r sum(!is.na(df$title))` documents (`r round(100*mean(!is.na(df$title)))`%). There are `r length(unique(df$title))` unique titles.

```{r summarytitle, echo=FALSE, message=FALSE, warning=FALSE, fig.width=16, fig.height=10}
p <- top_plot(df, "title", ntop = ntop) +
  ggtitle(paste("Top titles")) +
  scale_y_log10() +
  ylab("Documents")
print(p)
```

## Language

Title count for the `r ncol(df %>% select(starts_with("language.")))-1` unique languages. Some documents may have more than one language listed.

[Unrecognized language entries](output.tables/language_unidentified.csv)  

```{r summarylang, echo=FALSE, message=FALSE, warning=FALSE, fig.width=7, fig.height=6}
dfs <- select(df, starts_with("language.")) %>% gather() %>% filter(value) %>% group_by(key) #%>% tally() %>% arrange(n)
dfs$key <- gsub("language\\.", "", dfs$key)

p <- top_plot(dfs, "key", nrow(dfs)) +
  ggtitle(paste("Languages")) +
  scale_y_log10() +
  ylab("Documents") +
  guides(color = "none")
print(p)
```

